{"host":"console-stg.cloud.vmware.com","tags":[{"description":"Usage report submission related operations","name":"Usage Reports"}],"securityDefinitions":{"token":{"in":"header","name":"csp-auth-token","type":"apiKey"}},"produces":["application/json"],"definitions":{"CreateUsageReportRequest":{"type":"object","properties":{"uploadUrlTtl":{"allowEmptyValue":false,"type":"string","description":"File upload URL validity duration. Expiration time is an ISO 8601 duration from the report creation time. Minimum duration is one minute. Maximum duration is 12 hours. Default duration value is 12 hours. Format spec: https://en.wikipedia.org/wiki/ISO_8601#Durations"},"reportType":{"enum":["RAW","RAW_VMC"],"allowEmptyValue":false,"type":"string","description":"Usage report schema"},"fileChecksum":{"allowEmptyValue":false,"type":"string","description":"base64 encoded md5 signature.One line calculation: '$>openssl dgst -md5 -binary file.json.gz | base64'"},"context":{"type":"object","allowEmptyValue":false,"additionalProperties":{"type":"string"},"description":"Service specific JSON resource attributes that were sent in report creation request by service"},"numberOfRecords":{"description":"The number of usage records in the file","allowEmptyValue":false,"type":"integer","format":"int64"}},"title":"CreateUsageReportRequest","required":["fileChecksum","numberOfRecords","reportType"]},"UsageReportDto":{"type":"object","properties":{"lastUpdateTime":{"description":"The time the report was updated, ISO-8601 time format.","allowEmptyValue":false,"type":"string","format":"date-time"},"missingRecordsCount":{"description":"The count of missing records (from what reportedRecordsCount has)","allowEmptyValue":false,"type":"integer","format":"int64"},"uploadUrl":{"allowEmptyValue":false,"type":"string","description":"The URL where the file needs to be uploaded. No value is available after CSP_PROCESSING status"},"serviceDefinitionId":{"allowEmptyValue":false,"type":"string","description":"Service definition ID"},"creationTime":{"description":"The time in which the report has been created, ISO-8601 time format.","allowEmptyValue":false,"type":"string","format":"date-time"},"status":{"enum":["PENDING_UPLOAD","CSP_PROCESSING","BILLING_PROVIDER_PROCESSING","FINISHED","CANCELED","EXPIRED"],"allowEmptyValue":false,"type":"string","description":"Report status"},"context":{"type":"object","allowEmptyValue":false,"additionalProperties":{"type":"string"},"description":"Arbitrary Service specific JSON resource attributes"},"usageReportId":{"allowEmptyValue":false,"type":"string","description":"The Usage Report ID"},"expirationTime":{"description":"Upload URL expiration time, ISO-8601 time format.","allowEmptyValue":false,"type":"string","format":"date-time"},"reportedRecordsCount":{"description":"Total records in the report reported by the Service uploading the report. reportedRecordCount = processedRecordCount + failedRecordCount + missingRecordCount","allowEmptyValue":false,"type":"integer","format":"int64"},"reportType":{"enum":["RAW","RAW_VMC"],"allowEmptyValue":false,"type":"string","description":"Usage report schema"},"errorReportChecksum":{"allowEmptyValue":false,"type":"string","description":"base64 encoded md5 signature. Only present if downloadUrl is available. If failedRecordsCount is Zero then this is not available. <br> One line calculation: <b>'$>openssl dgst -md5 -binary file.json.gz | base64'</b>"},"processedRecordsCount":{"description":"Total records processed by CSP. The value is populated only if status is FINISHED.","allowEmptyValue":false,"type":"integer","format":"int64"},"failedRecordsCount":{"description":"Failed records out of the processed records. The value is populated only if status is FINISHED.","allowEmptyValue":false,"type":"integer","format":"int64"},"errors":{"items":{"$ref":"#/definitions/ErrorsDto"},"allowEmptyValue":false,"type":"array","description":"This is provided once report is in FINISHED state. Record level errors will be inside the error file"}},"title":"UsageReportDto","required":["missingRecordsCount","reportType"]},"ErrorsDto":{"type":"object","properties":{"message":{"allowEmptyValue":false,"type":"string","description":"A human readable message"},"field":{"allowEmptyValue":false,"type":"string","description":"Refers to one of the fields in the usage record"},"error":{"enum":["REQUIRED_VALUE","INVALID_VALUE","DUPLICATE_VALUE","INVALID_RANGE","INVALID_DOCUMENT","NOT_FOUND","NOT_ACTIVE","UNMAPPED_ERROR","FILE_NOT_FOUND","CHECKSUM_FAIL","COMPRESSION_FAIL","FILE_READ_ERROR","RECORDS_COUNT_MISMATCH","RECORDS_WITH_ERROR"],"allowEmptyValue":false,"type":"string","description":"From the enum"}},"title":"ErrorsDto","required":["error","message"]},"PagedResponseOfUsageReportDto":{"properties":{"prevLink":{"description":"Relative path to previous page if exists. Not returned for POST requests","allowEmptyValue":false,"example":"/csp/serviceName/ResourceName?pageStart=30&pageLimit=15","type":"string"},"nextLink":{"description":"Relative path to next page if exists. Not returned for POST requests","allowEmptyValue":false,"example":"/csp/serviceName/ResourceName?pageStart=60&pageLimit=15","type":"string"},"totalResults":{"allowEmptyValue":false,"description":"Total amount of results if available","format":"int32","example":2000,"type":"integer"},"results":{"items":{"$ref":"#/definitions/UsageReportDto"},"allowEmptyValue":false,"type":"array","description":"List of results"}},"title":"PagedResponseOfUsageReportDto","type":"object"},"UsageReportResultDto":{"type":"object","properties":{"lastUpdateTime":{"description":"The time the report was updated, ISO-8601 time format.","allowEmptyValue":false,"type":"string","format":"date-time"},"errorReportChecksum":{"allowEmptyValue":false,"type":"string","description":"base64 encoded md5 signature. Only present if downloadUrl is available. If failedRecordsCount is Zero then this is not available. <br> One line calculation: <b>'$>openssl dgst -md5 -binary file.json.gz | base64'</b>"},"downloadFileExpirationTime":{"description":"Download URL expiration time. Only present if downloadUrl is available. If failedRecordsCount is Zero then this is not available.","allowEmptyValue":false,"type":"string","format":"date-time"},"creationTime":{"description":"The time in which the report has been created, ISO-8601 time format.","allowEmptyValue":false,"type":"string","format":"date-time"},"status":{"enum":["PENDING_UPLOAD","CSP_PROCESSING","BILLING_PROVIDER_PROCESSING","FINISHED","CANCELED","EXPIRED"],"allowEmptyValue":false,"type":"string","description":"Report status"},"usageReportId":{"allowEmptyValue":false,"type":"string","description":"The Usage Report ID"},"processedRecordsCount":{"description":"Total records processed by CSP. The value is populated only if status is FINISHED.","allowEmptyValue":false,"type":"integer","format":"int64"},"uploadUrl":{"allowEmptyValue":false,"type":"string","description":"The URL where the file needs to be uploaded. No value is available after CSP_PROCESSING status"},"missingRecordsCount":{"description":"The count of missing records (from what reportedRecordsCount has)","allowEmptyValue":false,"type":"integer","format":"int64"},"downloadUrl":{"allowEmptyValue":false,"type":"string","description":"The URL where the processing results can be downloaded. The value is populated only if status is FINISHED. If failedRecordsCount is Zero then this is not available."},"reportedRecordsCount":{"description":"Total records in the report reported by the Service uploading the report. reportedRecordCount = processedRecordCount + failedRecordCount + missingRecordCount","allowEmptyValue":false,"type":"integer","format":"int64"},"serviceDefinitionId":{"allowEmptyValue":false,"type":"string","description":"Service definition ID"},"failedRecordsCount":{"description":"Failed records out of the processed records. The value is populated only if status is FINISHED.","allowEmptyValue":false,"type":"integer","format":"int64"},"expirationTime":{"description":"Upload URL expiration time, ISO-8601 time format.","allowEmptyValue":false,"type":"string","format":"date-time"},"reportType":{"enum":["RAW","RAW_VMC"],"allowEmptyValue":false,"type":"string","description":"Usage report schema"},"context":{"type":"object","allowEmptyValue":false,"additionalProperties":{"type":"string"},"description":"Arbitrary Service specific JSON resource attributes"},"errors":{"items":{"$ref":"#/definitions/ErrorsDto"},"allowEmptyValue":false,"type":"array","description":"This is provided once report is in FINISHED state. Record level errors will be inside the error file"}},"title":"UsageReportResultDto","required":["missingRecordsCount","reportType"]}},"info":{"title":"Usage Meter","description":"List of all Usage Meter APIs","version":"1.0"},"swagger":"2.0","consumes":["application/json"],"basePath":"/csp/gateway","paths":{"/um/api/v1/service-definitions/{serviceDefinitionId}/usage-reports/{usageReportId}/results":{"get":{"responses":{"500":{"description":"Internal Server Error"},"401":{"description":"Unauthorized"},"200":{"schema":{"$ref":"#/definitions/UsageReportResultDto"},"description":"OK"},"403":{"description":"Forbidden"}},"summary":"Get results of a usage report submission. It must be in FINISHED state","operationId":"getUsageReportResultUsingGET","tags":["Usage Reports"],"security":[{"token":["global"]},{"cspAuthentication":["platform_operator","service_owner"]},{"cspServiceAuthentication":["service"]}],"description":"null\n### Access Policy:\n| Role | User Accounts | Service Accounts (Client Credentials Applications)  |\n| ----- | ----- | ---------- |\n| Service Owner | &#x2714;&#xFE0F; | &#x2714;&#xFE0F; |\n| Read-only Operator | &#x2714;&#xFE0F; | &#x2714;&#xFE0F; |\n","parameters":[{"required":false,"in":"path","name":"serviceDefinitionId","description":"The service definition id","type":"string"},{"required":false,"in":"path","name":"usageReportId","description":"The usage report id","type":"string"}]}},"/um/api/v1/service-definitions/{serviceDefinitionId}/usage-reports":{"post":{"responses":{"500":{"description":"Internal Server Error"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"},"201":{"schema":{"$ref":"#/definitions/UsageReportDto"},"description":"Created"}},"summary":"Create new usage report to allow upload of a usage file","operationId":"createUsageReportUsingPOST","tags":["Usage Reports"],"security":[{"token":["global"]},{"cspAuthentication":["platform_operator","service_owner"]},{"cspServiceAuthentication":["service"]}],"description":"null\n### Access Policy:\n| Role | User Accounts | Service Accounts (Client Credentials Applications)  |\n| ----- | ----- | ---------- |\n| Service Owner | &#x2714;&#xFE0F; | &#x2714;&#xFE0F; |\n","parameters":[{"required":false,"in":"path","name":"serviceDefinitionId","description":"The service definition id","type":"string"},{"description":"createUsageReportRequest","in":"body","name":"createUsageReportRequest","schema":{"$ref":"#/definitions/CreateUsageReportRequest"},"required":true}]},"get":{"responses":{"500":{"description":"Internal Server Error"},"401":{"description":"Unauthorized"},"200":{"schema":{"$ref":"#/definitions/PagedResponseOfUsageReportDto"},"description":"OK"},"403":{"description":"Forbidden"}},"summary":"Get service usage reports","operationId":"getServiceUsageReportsUsingGET","tags":["Usage Reports"],"security":[{"token":["global"]},{"cspAuthentication":["platform_operator","service_owner"]},{"cspServiceAuthentication":["service"]}],"description":"null\n### Access Policy:\n| Role | User Accounts | Service Accounts (Client Credentials Applications)  |\n| ----- | ----- | ---------- |\n| Service Owner | &#x2714;&#xFE0F; | &#x2714;&#xFE0F; |\n| Read-only Operator | &#x2714;&#xFE0F; | &#x2714;&#xFE0F; |\n","parameters":[{"required":false,"in":"path","name":"serviceDefinitionId","description":"The service definition id","type":"string"},{"format":"int32","description":"pageStart","required":false,"in":"query","name":"pageStart","default":1,"type":"integer"},{"format":"int32","description":"pageLimit","required":false,"in":"query","name":"pageLimit","default":20,"type":"integer"}]}},"/um/api/v1/service-definitions/{serviceDefinitionId}/usage-reports/{usageReportId}":{"post":{"responses":{"500":{"description":"Internal Server Error"},"401":{"description":"Unauthorized"},"200":{"schema":{"$ref":"#/definitions/UsageReportDto"},"description":"OK"},"403":{"description":"Forbidden"}},"summary":"Actions on an usage report","operationId":"actionOnUsageReportUsingPOST","tags":["Usage Reports"],"security":[{"token":["global"]},{"cspAuthentication":["platform_operator"]},{"cspServiceAuthentication":["service"]}],"description":"null\n### Access Policy:\n| Role | User Accounts | Service Accounts (Client Credentials Applications)  |\n| ----- | ----- | ---------- |\n","parameters":[{"required":false,"in":"path","name":"serviceDefinitionId","description":"The service definition id","type":"string"},{"required":false,"in":"path","name":"usageReportId","description":"The usage report id","type":"string"},{"enum":["CANCEL"],"required":false,"in":"query","name":"action","description":"Action to perform","type":"string"}]},"get":{"responses":{"500":{"description":"Internal Server Error"},"401":{"description":"Unauthorized"},"200":{"schema":{"$ref":"#/definitions/UsageReportDto"},"description":"OK"},"403":{"description":"Forbidden"}},"summary":"Get details of a specific usage report","operationId":"getUsageReportUsingGET","tags":["Usage Reports"],"security":[{"token":["global"]},{"cspAuthentication":["platform_operator","service_owner"]},{"cspServiceAuthentication":["service"]}],"description":"null\n### Access Policy:\n| Role | User Accounts | Service Accounts (Client Credentials Applications)  |\n| ----- | ----- | ---------- |\n| Service Owner | &#x2714;&#xFE0F; | &#x2714;&#xFE0F; |\n| Read-only Operator | &#x2714;&#xFE0F; | &#x2714;&#xFE0F; |\n","parameters":[{"required":false,"in":"path","name":"serviceDefinitionId","description":"The service definition id","type":"string"},{"required":false,"in":"path","name":"usageReportId","description":"The usage report id","type":"string"}]}}}}